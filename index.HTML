<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon"  id= "favion" href="./to-do-list_icon.png" type="image/x-icon">
        <title>TODO - List</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
            crossorigin="anonymous">
            <link rel="stylesheet" href="style.css">
        <style>
        main {
            margin: 50px 300px;
        }
    </style>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg  navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">TODO - List </a>
                <button class="navbar-toggler" type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse"
                    id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page"
                                href="#">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Contact</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#"
                                role="button" data-bs-toggle="dropdown"
                                aria-expanded="false">
                                Dropdown
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">Action</a></li>
                                <li><a class="dropdown-item" href="#">Another
                                        action</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">Something
                                        else here</a></li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" aria-disabled="true">Disabled</a>
                        </li>
                    </ul>
                    <form class="d-flex" role="search">
                        <input class="form-control me-2" type="search"
                            placeholder="Search" aria-label="Search">
                        <button class="btn btn-outline-success" type="submit">Search</button>
                    </form>
                </div>
            </div>
        </nav>
        <div class="container">
            <h2 class="text-center">TODO List</h2>
        </div>
        <br>
        <main>
            <div class="form">

                <div class="mb-3">
                    <label for="Title" class="form-label">Title</label>
                    <input type="email" class="form-control" id="Title"
                        placeholder>
                </div>
                <div class="mb-3">
                    <label for="Description" class="form-label">Description</label>
                    <textarea class="form-control" id="Description" rows="3"></textarea>
                </div>
                <button class="btn btn-primary" id="add">Add to List</button>
                <button class="btn uday btn-primary" id="clear" onclick="Clear()">Clear List</button>
            </div>
            <br><br>
            <div class="items" class="my-4">
                <h2>Your Items</h2>
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">SNo</th>
                            <th scope="col">Item Title</th>
                            <th scope="col">Item Description</th>
                            <th scope="col">Actions</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr id="trow">
                            <th scope="row">1</th>
                            <td id="c1">Get Some Coffee</td>
                            <td id="c2">You need coffie as you are a coder</td>
                            <td><button class="btn btn-primary  btn-sm" id="edit">Edit</button></td>
                            <td><button class="btn btn-primary  btn-sm">Delete</button></td>
                        </tr>

                    </tbody>
                </table>

            </div>

        </main>
        <script>
        let add = document.getElementById("add");
        let edit = document.getElementById("edit");
        let itemJsonArrayStr = localStorage.getItem('itemsJson');
        let itemJsonArray = JSON.parse(itemJsonArrayStr);
        let tableBody = document.getElementById("tableBody");
        let str = "";
        update(0);
        function update(a1) {
            if (a1 == 1) {
            let itemJsonArray;
            let tit = document.getElementById('Title').value;
            let desc = document.getElementById('Description').value;
            console.log("Updating List")
                if (localStorage.getItem('itemsJson') == null) {
                    let itemJsonArray = [];
                    itemJsonArray.push([tit, desc]);
                    localStorage.setItem('itemsJson', JSON.stringify(itemJsonArray))
                }
                else {
                    let itemJsonArrayStr = localStorage.getItem('itemsJson');
                    itemJsonArray = JSON.parse(itemJsonArrayStr);
                    itemJsonArray.push([tit, desc]);
                    localStorage.setItem('itemsJson', JSON.stringify(itemJsonArray))
                }
                tableBody = document.getElementById("tableBody");
            str = "";
            if(itemJsonArray!=null){
            itemJsonArray.forEach((element, index) => {
                str = str +
                    `<tr id="trow">
                    <th scope="row">${index + 1}</th>
                    <td>${element[0]}</td>
                    <td>${element[1]}</td>
                    <td><button class="btn btn-primary  btn-sm" id="edit" onclick="Edit(${index})" >Edit</button></td>
                    <td><button class="btn btn-primary  btn-sm" id="edit" onclick="Delete(${index})">Delete</button></td>
                  </tr>`
                });
            }
            tableBody.innerHTML = str;
            }
            else{
                let str = "";
                if(itemJsonArray!=null){
                 itemJsonArray.forEach((element, index) => {
                     str = str +
                         `<tr id="trow">
                          <th scope="row">${index + 1}</th>
                          <td>${element[0]}</td>
                          <td>${element[1]}</td>
                          <td><button class="btn btn-primary  btn-sm" id="edit" onclick="Edit(${index})" >Edit</button></td>
                          <td><button class="btn btn-primary  btn-sm" onclick="Delete(${index})">Delete</button></td>
                        </tr>`
                 });
                }
                 tableBody.innerHTML = str;
            }
        
            
        }

        add.addEventListener("click", ()=>{
            update(1);
        });
        function Delete(itemindex){
                  console.log("Delete",itemindex+1);
                  let  itemJsonArrayStr=localStorage.getItem('itemsJson');
                  itemJsonArray=JSON.parse(itemJsonArrayStr);
                  //Delete itemindex from the array
                  itemJsonArray.splice(itemindex,1);
                  localStorage.setItem('itemsJson',JSON.stringify(itemJsonArray))
                  update(0);
                  
              } 
              function Clear(){
                if(confirm("Do you really want to clear ?")){
                console.log("clearing the storage");
                localStorage.clear();
                update(0);
              }
              }
    </script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
            crossorigin="anonymous"></script>
    </body>

</html>